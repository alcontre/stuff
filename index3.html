<style>
    .myAAAcontainer {
        display: flex;
        min-height: 100vh;
    }

    .myAAAcontainer nav {
        width: 260px;
        position: sticky;
        top: 0;
        height: 100vh;
        border-right: 1px solid #ccc;
        padding: 1rem;
        overflow-y: auto;
        background-color: #2c3e50;
        color: #ecf0f1;
    }

    .myAAAcontainer nav h2 {
        margin-top: 0;
    }

    .myAAAcontainer nav a {
        color: #3498db;
        text-decoration: none;
    }

    .myAAAcontainer nav a:hover {
        color: #5dade2;
        text-decoration: underline;
    }

    .myAAAcontainer main {
        flex: 1;
        padding: 1.5rem;
        overflow-y: auto;
    }

    .myAAAcontainer main h1 {
        margin-top: 0;
    }

    .myAAAcontainer main details summary span {
        display: inline;
        margin: 0;
        padding: 0;
        font-weight: bold;
    }

    .myAAAcontainer main details {
        margin: 1rem 0;
    }

    .myAAAcontainer main details summary {
        cursor: pointer;
        font-weight: bold;
        padding: 0.5em;
        list-style: none;
    }

    /* We use ::before rather than ::marker because confluence HTML Include
    appears to strip out ::marker*/
    .myAAAcontainer main details summary::before {
        content: '▶ ';
        display: inline-block;
        width: 1em;
        text-align: center;
        font-family: monospace;
    }

    .myAAAcontainer main details[open]>summary::before {
        content: '▼ ';
    }

    .myAAAcontainer main details>*:not(summary) {
        margin-left: 1.5rem;
    }

    .myAAAcontainer nav details {
        margin: 0.5rem 0;
    }

    .myAAAcontainer nav details summary {
        cursor: pointer;
        font-weight: bold;
        padding: 0.25em 0;
        list-style: none;
    }

    .myAAAcontainer nav details summary::before {
        content: '▶ ';
        display: inline-block;
        width: 1em;
        text-align: center;
        font-family: monospace;
    }

    .myAAAcontainer nav details[open]>summary::before {
        content: '▼ ';
    }

    /* Indentation for nested elements ("details") */
    .myAAAcontainer nav details>*:not(summary) {
        margin-left: 1.5rem;
    }

    script {
        display: none;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {

        // Find all details elements in main and build nav
        function buildNav(parent, targetContainer) {
            const childDetails = Array.from(parent.children).filter(child => child.tagName === 'DETAILS');

            childDetails.forEach(detail => {
                const titleSpan = detail.querySelector(':scope > summary span');
                const id = detail.id;
                const text = titleSpan ? titleSpan.textContent : '';

                const detailsNav = document.createElement('details');
                const summaryNav = document.createElement('summary');
                const link = document.createElement('a');

                link.href = '#' + id;
                link.textContent = text;
                summaryNav.appendChild(link);
                detailsNav.appendChild(summaryNav);

                // Check if original detail has child details
                const nestedDetails = Array.from(detail.children).filter(child => child.tagName === 'DETAILS');
                if (nestedDetails.length > 0) {
                    // Mark parent as open if any children exist
                    detailsNav.setAttribute('open', '');
                    // Recursively build nav for nested details
                    buildNav(detail, detailsNav);
                }

                targetContainer.appendChild(detailsNav);
            });
        }

        const mainElement = document.querySelector('.myAAAcontainer main');
        const navContainer = document.createElement('div');
        navContainer.id = 'myAAAnavContainer';
        buildNav(mainElement, navContainer);

        // Insert the generated nav before the main details
        const navElement = document.querySelector('.myAAAcontainer nav');
        const mainFirstChild = navElement.querySelector('h2').nextSibling;
        if (mainFirstChild) {
            mainFirstChild.parentNode.insertBefore(navContainer, mainFirstChild);
        } else {
            navElement.appendChild(navContainer);
        }
    });
</script>
<div class="myAAAcontainer">
    <nav aria-label="Navigation">
        <h2>Sections</h2>
    </nav>

    <main>
        <h1>Binary Data Format Description</h1>
        <details id="myAAA1" open>
            <summary><span>1 File Header</span></summary>
            <p>The file header contains metadata about the binary format structure and version.</p>

            <details id="myAAA1-1">
                <summary><span>1.1 Signature</span></summary>
                <p>Magic bytes indicating format identity.</p>
            </details>

            <details id="myAAA1-2">
                <summary><span>1.2 Version</span></summary>
                <p>16-bit integer identifying schema revision.</p>
            </details>
        </details>

        <details id="myAAA2" open>
            <summary><span>2 Chunk Table</span></summary>
            <p>The chunk table provides an index of all data chunks within the file.</p>

            <details id="myAAA2-1">
                <summary><span>2.1 Chunk Entry</span></summary>
                <p>Repeated entries describing each payload chunk.</p>

                <details id="myAAA2-1-1">
                    <summary><span>2.1.1 Chunk Type</span></summary>
                    <p>Enumerated value describing purpose.</p>
                </details>

                <details id="myAAA2-1-2">
                    <summary><span>2.1.2 Chunk Offset</span></summary>
                    <p>32-bit offset from file start.</p>
                </details>

                <details id="myAAA2-1-3">
                    <summary><span>2.1.3 Chunk Size</span></summary>
                    <p>32-bit length in bytes.</p>
                </details>
            </details>
        </details>

        <details id="myAAA3" open>
            <summary><span>3 Payload</span></summary>
            <p>The payload section contains the actual data content organized into structured blocks.</p>

            <details id="myAAA3-1">
                <summary><span>3.1 Metadata Block</span></summary>
                <p>Optional key/value pairs with UTF-8 strings.</p>
            </details>

            <details id="myAAA3-2">
                <summary><span>3.2 Data Block</span></summary>
                <p>One or more records of the primary content.</p>

                <details id="myAAA3-2-1">
                    <summary><span>3.2.1 Record Header</span></summary>
                    <p>Flags and length for each record.</p>
                </details>

                <details id="myAAA3-2-2">
                    <summary><span>3.2.2 Record Body</span></summary>
                    <p>Raw bytes interpreted per chunk type.</p>
                </details>
            </details>
        </details>
    </main>
</div>